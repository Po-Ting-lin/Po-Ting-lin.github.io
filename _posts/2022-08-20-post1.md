---
layout: post
title: "Fast Integral Image in CUDA"
date: 2022-08-20
description: "Implement and modified a fast integral image"
tags: [CUDA, Image Processing]
---

## Introduction
Implementation of integral image, according to the paper[1]. 
The paper proposed "Blocked Integral Image" which can expose more parallelism than the version of cv::cuda::integral.
Rather than using parallel scan mentioned in the paper,
I use CUDA intrinsic __shfl_up_sync to improve the single scan.
Since opencv cannot support 64 bits integer, 
this repo also supports 64 bits integer to avoid overflow for the large input image.

### Requirements
* CUDA >= 6

## References

```
[1] Dang, Qingqing, Shengen Yan, and Ren Wu. 
    "A fast integral image generation algorithm on GPUs." 
    2014 20th IEEE International Conference on Parallel and Distributed Systems (ICPADS). IEEE, 2014.
```

## Test
Method               |Image Size     | Elapsed Time
---------------------|:-------------:|--------------
OpenCV CUDA module   |256 * 256      |  0.53 ms
Modified block method|256 * 256      |  0.14 ms (x3.78 speedup)
OpenCV CUDA module   |1024 * 1024    |  1.86 ms
Modified block method|1024 * 1024    |  0.82 ms (x2.26 speedup)
OpenCV CUDA module   |5120 * 5120    |  26.37 ms
Modified block method|5120 * 5120    |  17.71 ms (x1.48 speedup)

